{% extends 'base.html' %} {% block content %}
<h2>{{ server.name }} - Components</h2>

<div class="server-info-card">
  <p>
    <strong>IP:</strong> {{ server.ip }} | <strong>Brand:</strong> {{
    server.brand }} | <strong>SNMP:</strong> {{ server.snmp_version }}
  </p>
</div>

<div class="toolbar-actions">
  <a href="{{ url_for('server.servers') }}" class="btn btn-secondary"
    >&laquo; Back to Server List</a
  >
  <a
    href="{{ url_for('component.add_component', server_id=server.id) }}"
    class="btn"
    >+ Add Component</a
  >
</div>

{% if components %}
<table class="component-table">
  <thead>
    <tr>
      <th>No</th>
      <th>Name</th>
      <th>OID</th>
      <th>Category</th>
      <th>Brand</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for c in components %}
    <tr>
      <td>
        {{ (pagination.page - 1) * pagination.per_page + loop.index if
        pagination else loop.index }}
      </td>
      <td>{{ c.name }}</td>
      <td><code>{{ c.oid }}</code></td>
      <td>
        <span class="category-badge {{ c.category }}">{{ c.category }}</span>
      </td>
      <td>{{ c.brand }}</td>
      <td>
        <a
          href="{{ url_for('component.edit_component', server_id=server.id, component_id=c.id) }}"
          class="btn btn-sm"
          >Edit</a
        >
        <form
          method="post"
          action="{{ url_for('component.delete_component', server_id=server.id, component_id=c.id) }}"
          style="display: inline"
          onsubmit="
            return confirm('Are you sure you want to delete this component?');
          "
        >
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
          <button type="submit" class="btn btn-sm btn-danger">Delete</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- Pagination -->
{% if pagination and pagination.pages > 1 %}
<div class="pagination">
  {% if pagination.has_prev %}
  <a
    href="{{ url_for('component.components', server_id=server.id, page=pagination.prev_num) }}"
    class="btn btn-sm"
    >&laquo; Prev</a
  >
  {% endif %}
  <span class="page-info"
    >Page {{ pagination.page }} of {{ pagination.pages }}</span
  >
  {% if pagination.has_next %}
  <a
    href="{{ url_for('component.components', server_id=server.id, page=pagination.next_num) }}"
    class="btn btn-sm"
    >Next &raquo;</a
  >
  {% endif %}
</div>
{% endif %} {% else %}
<div class="no-data">
  <p>No components found for this server.</p>
  <p>
    <a
      href="{{ url_for('component.add_component', server_id=server.id) }}"
      class="btn"
      >+ Add your first component</a
    >
  </p>
</div>
{% endif %} {% endblock %}
